{"version":3,"sources":["webpack://randomUser/./src/index.js"],"names":["words","arrResultUsers","filtredUsers","searchValue","selectedOptions","refs","loadMore","document","querySelector","usersContainer","user","spiner","statistic","usersFilter","search","sort","select","replaceMurkup","users","map","makeUserCard","classList","add","picture","name","gender","phone","email","location","dob","registered","dateBirthday","Date","date","dateBirthdayContent","validDate","getUTCDate","getUTCMonth","getUTCFullYear","dateRegistered","dateRegisteredContent","replacedUser","innerHTML","replaceAll","large","replace","last","first","state","city","street","insertAdjacentHTML","value","String","padStart","getStatistics","female","filter","male","dominantGender","stats","flatMap","nat","reduce","acc","nationality","replacesStatistics","length","Object","entries","makeNationalityMarkUp","join","createNationalityList","key","declensionUser","number","declensionAmount","clearCardesContainer","redrawing","filtersBySearch","val","item","toLowerCase","includes","addEventListener","e","randomUsers","url","remove","Math","floor","random","fetch","then","response","json","results","target","trim","keyCode","preventDefault","this","a","b","localeCompare","sortByOption"],"mappings":"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","file":"bundle.js","sourcesContent":["import \"./scss/index.scss\";\r\n\r\nconst BASE_URL = \"https://randomuser.me/api/\";\r\nconst words = [\"пользователь\", \"пользователя\", \"пользователей\"];\r\nlet arrResultUsers = [];\r\nlet filtredUsers = [];\r\nlet searchValue = \"\";\r\nlet selectedOptions = \"\";\r\nlet selectedDefault = true;\r\n\r\nconst refs = {\r\n  loadMore: document.querySelector(\"[data-load-more]\"),\r\n  usersContainer: document.querySelector(\"[data-users-container]\"),\r\n  user: document.querySelector(\"#user-template\"),\r\n  spiner: document.querySelector(\"[data-load-spiner]\"),\r\n  statistic: document.querySelector(\"#statistics\"),\r\n  usersFilter: document.querySelector(\".users__filters\"),\r\n  search: document.querySelector(\"[data-input-search]\"),\r\n  sort: document.querySelector(\".sort\"),\r\n  select: document.querySelector(\"#sort-control\"),\r\n};\r\n\r\nfunction getRandomUser(max) {\r\n  return Math.floor(Math.random() * max);\r\n}\r\n\r\nrefs.loadMore.addEventListener(\"click\", onLoad);\r\n\r\nfunction onLoad(e) {\r\n  refs.spiner.classList.remove(\"is-hidden\");\r\n  refs.search.value = \"\";\r\n  clearCardesContainer();\r\n  fetchUsers();\r\n}\r\n\r\nfunction getUsers(randomUsers) {\r\n  const url = `${BASE_URL}?results=${randomUsers}`;\r\n\r\n  return fetch(url)\r\n    .then((response) => response.json())\r\n    .then(({ results }) => {\r\n      return results;\r\n    });\r\n}\r\n\r\nfunction fetchUsers() {\r\n  getUsers(getRandomUser(101)).then((users) => {\r\n    arrResultUsers = [...users];\r\n    filtredUsers = [...users];\r\n    replaceMurkup(arrResultUsers);\r\n    getStatistics(arrResultUsers);\r\n    onSearch();\r\n    onSelect();\r\n  });\r\n}\r\n\r\nfunction replaceMurkup(users) {\r\n  users.map(makeUserCard);\r\n  refs.spiner.classList.add(\"is-hidden\");\r\n}\r\n\r\nfunction makeUserCard({\r\n  picture,\r\n  name,\r\n  gender,\r\n  phone,\r\n  email,\r\n  location,\r\n  dob,\r\n  registered,\r\n}) {\r\n  const dateBirthday = new Date(dob.date);\r\n  const dateBirthdayContent = `${validDate(\r\n    dateBirthday.getUTCDate()\r\n  )}-${validDate(\r\n    dateBirthday.getUTCMonth() + 1\r\n  )}-${dateBirthday.getUTCFullYear()}`;\r\n\r\n  const dateRegistered = new Date(registered.date);\r\n  const dateRegisteredContent = `${validDate(\r\n    dateRegistered.getUTCDate()\r\n  )}-${validDate(\r\n    dateRegistered.getUTCMonth() + 1\r\n  )}-${dateRegistered.getUTCFullYear()}`;\r\n\r\n  const replacedUser = refs.user.innerHTML\r\n    .replaceAll(/{{hrefImg}}/gi, picture.large)\r\n    .replace(/{{lastName}}/, name.last)\r\n    .replace(/{{firstName}}/, name.first)\r\n    .replace(/{{gender}}/, gender)\r\n    .replaceAll(/{{phone}}/gi, phone)\r\n    .replaceAll(/{{email}}/gi, email)\r\n    .replace(/{{state}}/, location.state)\r\n    .replace(/{{city}}/, location.city)\r\n    .replace(/{{street}}/, location.street.name)\r\n    .replace(/{{birthday}}/, dateBirthdayContent)\r\n    .replace(/{{registered}}/, dateRegisteredContent);\r\n  refs.usersContainer.insertAdjacentHTML(\"afterbegin\", replacedUser);\r\n}\r\n\r\nfunction validDate(value) {\r\n  return String(value).padStart(2, \"0\");\r\n}\r\n\r\nfunction getStatistics(users) {\r\n  const female = users.filter((user) => user.gender === \"female\");\r\n  const male = users.filter((user) => user.gender === \"male\");\r\n  const dominantGender =\r\n    female > male ? \"женщин\" : female < male ? \"мужчин\" : \"равное количество\";\r\n\r\n  const stats = users\r\n    .flatMap((user) => user.nat)\r\n    .reduce(\r\n      (acc, nationality) => ({\r\n        ...acc,\r\n        [nationality]: acc[nationality] ? acc[nationality] + 1 : 1,\r\n      }),\r\n      {}\r\n    );\r\n\r\n  const replacesStatistics = refs.statistic.innerHTML\r\n    .replace(/{{users}}/, users.length)\r\n    .replace(/{{female}}/, female.length)\r\n    .replace(/{{male}}/, male.length)\r\n    .replace(/{{dominantGender}}/, dominantGender)\r\n    .replace(/{{nationality}}/, createNationalityList(stats));\r\n  refs.usersContainer.insertAdjacentHTML(\"beforeend\", replacesStatistics);\r\n}\r\n\r\nfunction createNationalityList(stats) {\r\n  return Object.entries(stats).map(makeNationalityMarkUp).join(\"\");\r\n}\r\n\r\nfunction makeNationalityMarkUp([key, value]) {\r\n  const declensionUser = declensionAmount(value, words);\r\n\r\n  return `<div>${key}: ${value} ${declensionUser}</div>`;\r\n}\r\n\r\nfunction declensionAmount(number, words) {\r\n  return words[\r\n    number % 100 > 4 && number % 100 < 20\r\n      ? 2\r\n      : [2, 0, 1, 1, 1, 2][number % 10 < 5 ? number % 10 : 5]\r\n  ];\r\n}\r\n\r\nfunction clearCardesContainer() {\r\n  refs.usersContainer.innerHTML = \"\";\r\n}\r\n\r\nfunction redrawing() {\r\n  clearCardesContainer();\r\n  replaceMurkup(filtredUsers);\r\n  getStatistics(filtredUsers);\r\n}\r\n\r\n// Stage 2\r\n\r\n// filters\r\n\r\nfunction onSearch() {\r\n  refs.usersFilter.classList.remove(\"is-hidden\");\r\n\r\n  refs.search.addEventListener(\"input\", (e) => {\r\n    searchValue = e.target.value.trim().toLowerCase();\r\n\r\n    filtersBySearch(searchValue);\r\n  });\r\n\r\n  refs.search.addEventListener(\"keypress\", (e) => {\r\n    e.keyCode == 13 && e.preventDefault();\r\n  });\r\n}\r\n\r\nfunction filtersBySearch(val) {\r\n  filtredUsers = arrResultUsers.filter((item) => {\r\n    const includesElemenet =\r\n      item.email.toLowerCase().includes(val) ||\r\n      item.phone.toLowerCase().includes(val) ||\r\n      item.name.first.toLowerCase().includes(val) ||\r\n      item.name.last.toLowerCase().includes(val);\r\n\r\n    return includesElemenet;\r\n  });\r\n\r\n  selectedDefault && redrawing();\r\n}\r\n\r\n// sort\r\n\r\nfunction onSelect() {\r\n  refs.sort.classList.remove(\"is-hidden\");\r\n\r\n  refs.select.addEventListener(\"change\", function (e) {\r\n    filtersBySearch(searchValue);\r\n    selectedOptions = this.value;\r\n    rewdrowSelectResult();\r\n  });\r\n}\r\n\r\nfunction rewdrowSelectResult() {\r\n  if (selectedDefault) {\r\n    filtredUsers = filtredUsers.sort(sortByOption(selectedOptions));\r\n  }\r\n\r\n  redrawing();\r\n}\r\n\r\nfunction sortByOption(val) {\r\n  switch (val) {\r\n    case \"1\":\r\n      return (a, b) => b.name.last.localeCompare(a.name.last);\r\n    case \"2\":\r\n      return (a, b) => a.name.last.localeCompare(b.name.last);\r\n    case \"3\":\r\n      return (a, b) => a.gender.localeCompare(b.gender);\r\n    case \"4\":\r\n      return (a, b) => b.gender.localeCompare(a.gender);\r\n    case \"5\":\r\n      return (a, b) =>\r\n        a.gender.localeCompare(b.gender) ||\r\n        b.name.last.localeCompare(a.name.last);\r\n    case \"6\":\r\n      return (a, b) =>\r\n        a.gender.localeCompare(b.gender) ||\r\n        a.name.last.localeCompare(b.name.last);\r\n    case \"7\":\r\n      return (a, b) =>\r\n        b.gender.localeCompare(a.gender) ||\r\n        b.name.last.localeCompare(a.name.last);\r\n    case \"8\":\r\n      return (a, b) =>\r\n        b.gender.localeCompare(a.gender) ||\r\n        a.name.last.localeCompare(b.name.last);\r\n    default:\r\n      !selectedDefault;\r\n      filtersBySearch(searchValue);\r\n  }\r\n}\r\n"],"sourceRoot":""}